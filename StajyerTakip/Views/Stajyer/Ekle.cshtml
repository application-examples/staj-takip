
@{
    ViewData["Title"] = "Ekle";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



<div class="container border-secondary">
    <div class="row">
        <div class="col-lg-2  col-md-12 h-25  ">
            <label class="cabinet center-block h-100 ">
                <figure class="h-100 text-center">
                    <img src="" class="gambar img-responsive img-thumbnail" style="" id="item-img-output" />
                    <figcaption class=""> <i class="fa fa-camera"> </i> </figcaption>

                </figure>
                <input type="file" class="item-img file center-block" name="file_photo" / >
            </label>
            <div class="modal fade" id="cropImagePop" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title" id="myModalLabel">
                                Fotoğrafı Düzenle
                            </h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true"> &times;</span> </button>

                        </div>
                        <div class="modal-body">
                            <div id="upload-demo" class="center-block text-center"> </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal"> Çıkış</button>
                            <button type="button" id="cropImageBtn" class="btn btn-primary"> Kırp</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-8 col-md-12">
            <form class="forms-sample" method="post" enctype="multipart/form-data" id="form1">
                <h5 class="">Hesap Bilgileri</h5>

                <hr />

                <div class="card card-body" style="border-radius:10px 20px;">
                    <div class="form-group">
                        <label for="ad">Ad</label>
                        <input type="text" class="form-control" id="ad" name="Profil.Ad" placeholder="Ad" required>
                    </div>
                    <div class="form-group">
                        <label for="soyad">Soyad</label>
                        <input type="text" class="form-control" id="soyad" name="Profil.Soyad" placeholder="Soyad" required>
                    </div>
                    <div class="form-group">
                        <label for="kullaniciadi">Kullanıcı Adı</label>
                        <input type="text" class="form-control" id="kullaniciadi" name="Profil.KullaniciAdi" placeholder="Kullancı Adı" required>
                        <div class="px-2 py-1" id="messageusername" hidden="hidden">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="Sifre">Şifre</label>
                        <input type="password" class="form-control" id="Sifre" name="Profil.Sifre" placeholder="Şifre" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group col-sm-4">
                            <label for="GunSayisi">Staj Süresi(Gün)</label>
                            <input type="text" id="GunSayisi" name="GunSayisi" class="form-control" placeholder="Staj Gün Sayısı" required />
                        </div>

                        <div class="form-group col-sm-4">
                            <label for="baslangictarihi">Başlangıç Tarihi:</label>
                            <input type="date" class="form-control" id="baslangictarihi" name="BaslangicTarihi" placeholder="Başlangıç Tarihi" required>
                        </div>

                        <div class="form-group col-sm-4">
                            <label for="bitistarihi">Bitiş Tarihi:</label>
                            <input type="date" class="form-control" id="bitistarihi" name="BitisTarihi" placeholder="Bitiş Tarihi" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Adres</label>
                        <input type="email" class="form-control" id="email" name="Profil.Email" placeholder="Email" required>
                        <div class="px-2 py-1" id="messagemail" hidden="hidden">

                        </div>
                        <div class="input-group" style="">
                            <div class="row col-12">
                                <label for="birim">Birim</label>
                            </div>
                            <select name="Birimler[]" id="select2" multiple="multiple" class="form-control" asp-items="@ViewBag.Birimler" required></select>
                        </div>
                    </div>
                    <h5>İletişim Bilgileri</h5>
                    <hr />
                    <div class="card card-body " style="border-radius:10px 20px;">
                        <div class="form-group">
                            <label for="telefonnumarasi">Telefon Numarası:</label>
                            <input type="text" id="telefon" class="form-control" pattern="[0-9]{3}-[0-9]{3}-[0-9]{2}-[0-9]{2}" name="Profil.Telefon" placeholder="Telefon Numarası">
                        </div>
                        <div class="form-group">
                            <label for="okul">Okulu:</label>
                            <input type="text" class="form-control" id="okul" name="Okul" placeholder="Okul" required>
                        </div>

                        <div class="form-group">
                            <label for="bolum">Bölümü:</label>
                            <input type="text" class="form-control" id="bolum" name="Bolum" placeholder="Bölüm" required>
                        </div>

                        <div class="form-group">
                            <label for="adres">Adres</label>
                            <input type="text" class="form-control" id="adres" name="Profil.Adres" placeholder="Adres">
                        </div>

                        <div class="form-row">
                            <div class="form-group col-sm-4">
                                <label for="il">İl</label>
                                <input type="text" class="form-control" id="il" name="Profil.Il" placeholder="İl">
                            </div>

                            <div class="form-group col-sm-4">
                                <label for="ilce">İlçe</label>
                                <input type="text" class="form-control" id="ilce" name="Profil.Ilce" placeholder="İlçe">
                            </div>

                            <div class="form-group col-sm-4">
                                <label for="sokak">Sokak</label>
                                <input type="text" class="form-control" id="sokak" name="Profil.Sokak" placeholder="Sokak">
                            </div>
                        </div>
                    </div>
                    <input type="text" class="custom-file-input" id="img" name="img" hidden />
                    <button id="submit" type="submit" class="btn btn-success ">Kaydet</button>
                    <button id="submit1" type="submit" hidden="hidden"></button>
                    <a href="~/Stajyer/Listele" class="btn btn-primary">İptal</a>
            </form>
        </div>
    </div>
</div>

<script>



    $(function () {
        var success_icon = '<i class="mdi mdi-check-circle text-success"></i>';
        var danger_icon = '<i class="mdi mdi-close-circle text-danger"></i>';
        $(document).on('keyup', '#kullaniciadi', function (e) {
            var html = "";
            $('#messageusername').prop('hidden', false);

            $.ajax({
                url: '/Account/UsernameCheck',
                data: { username: $('#kullaniciadi').val() },
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        html = '<div class="text-danger"><div>' + danger_icon + ' Kullanıcı adı zaten kullanımda.</div></div>';
                        $('#messageusername').html(html);
                    }
                    else {
                        html = '<div class="text-success"><div>' + success_icon + ' Kullanıcı adı kullanılabilir.</div></div>';
                        $('#messageusername').html(html);
                    }
                }
            });
        });

        $(document).on('keyup', '#email', function (e) {
            var html = "";
            $('#messagemail').prop('hidden', false);

            $.ajax({
                url: '/Account/EmailCheck',
                data: { email: $('#email').val() },
                dataType: 'json',
                success: function (data) {
                    if (data) {
                        html = '<div class="text-danger"><div>' + danger_icon + ' Email zaten kullanımda.</div></div>';
                        $('#messagemail').html(html);
                    }
                    else {
                        html = '<div class="text-success"><div>' + success_icon + ' Email kullanılabilir.</div></div>';
                        $('#messagemail').html(html);
                    }
                }
            });
        });
        $(document).on('click', '#submit', function (e) {
            e.preventDefault();

           //TODO: burada kodlar daha iyi optimize edilebilirdi, reusable kodlar oluşturulabilirdi ama zaman kısıtlı oldugu için böyle olmak zorunda ileride kodları düzenleyen biri olursa hallediversin.

            $.ajax({
                url: '/Account/UsernameCheck',
                data: { username: $('#kullaniciadi').val() },
                dataType: 'json',
                success: function (data) {
                    if (!data) {
                    }
                    else {
                        $('#kullaniciadi').focus();
                        return;
                    }
                }
            });

            $.ajax({
                url: '/Account/EmailCheck',
                data: { email: $('#email').val() },
                dataType: 'json',
                success: function (data) {
                    if (!data) {
                        $('#submit1').click();
                    }
                    else {
                        $('#email').focus();
                        return;
                    }
                }
            });
        });
    });


    $('#telefon').inputmask({ "mask": "0(999) 999-9999" });
    $('#select2').select2({
        placeholder: 'Birim seçin',
        theme: 'bootstrap4',
        width: 'element'
    });
    $(".gambar").attr("src", "https://user.gadjian.com/static/images/personnel_boy.png");
</script>
<script src="~/js/photo-edit.js">

</script>